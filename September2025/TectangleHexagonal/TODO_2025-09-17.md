# TODO — 2025-09-17

Purpose: Ensure rich telemetry emits every frame post seat-lock (for active hands), decouple inline UI toward hex-UI, and prep multiplayer demo.

## Priorities (ordered)
1) Emit per-frame rich post-lock (Done)
2) V13 UI standardization (Tailwind shell)
3) Angle velocity & jerk + smoothing
4) Throttle config unification
5) Exporter parity for per-frame (Done) and add pre-lock mode
6) UI tests coverage bump
7) Perf budget + docs
8) Multiplayer dino scaffold (carry)

---

### 1) Emit per-frame rich post-lock
- Acceptance
  - After seat-lock, for any active seat, `seatLockAdapter.snapshot().enriched[seat]` updates each frame (or at configured Hz) even without new pinch events.
  - Angle, velocity, accel, palmAngleDeg are non-zero when applicable and continuous.
- Tasks
  - AppShell: cache latest per-frame metrics per hand; expose `getRichSnapshot()` unchanged each frame.
  - HandSessionManager: ensure emits per-frame pinch:metrics for both hands when tracked.
  - seatLockRichAdapter: `tick()` merges latest shell rich per seat regardless of new events; maintain continuity.
  - Add unit smoke asserting consecutive snapshots have changing timestamps/values post-lock.

### 2) Hex UI module (decouple dashboard)
- Acceptance
  - A new `src/uiHex/richDashboard.js` renders the table given a provider `{ getEnriched(): object }`.
  - V11 uses hex UI under flag `FEATURE_HEX_DASHBOARD`, inline remains fallback.
- Tasks
  - Create module with minimal DOM binding + update loop.
  - Wire V11 to instantiate module when flag on.
  - Add smoke verifying it updates at 1 Hz with a stub provider.

### 3) Ring buffers + smoothing
- Acceptance
  - Per-seat ring buffer (≥60 samples) with derived vel/acc; optional EMA (alpha configurable) and Kalman (optional) applied.
- Tasks
  - Implement buffer in AppShell or adapter; expose in enriched.
  - Add unit tests for buffer push/pop and derivative correctness.

### 4) Throttle config unification
- Acceptance
  - Single config controls update/broadcast Hz (frame/30/10/5/1); both dashboard and sidecar honor it.
- Tasks
  - Move `richDue` to shared util; respect same source for both table and broadcaster.

### 5) Per-frame exporter parity
- Acceptance
  - Exporter asserts that for each active seat post-lock, at least N frames (e.g., 30) contain non-empty enriched.
- Tasks
  - Update `tests/export/export_v10_rich_telemetry.mjs` (clone to v11) with per-frame assertions and thresholds.

### 6) UI tests coverage bump
- Acceptance
  - New smoke validates cell updates at 1 Hz and match sidecar enriched keys.
- Tasks
  - Add puppeteer test to read table P1/P2 cells over time and ensure changes.

### 7) Perf budget + docs
- Acceptance
  - 30fps sustained with heavy viz off; doc flags and expected costs.
- Tasks
  - Measure in-page (frames/second, render cost) and document knobs.

### 8) Multiplayer dino scaffold
- Acceptance
  - Simple 2–4 seat one-button demo (jump) with ghost playback; no collisions.
- Tasks
  - Map seats→players; basic loop + keyboard stub; record/replay ghosts.

---

Owners: you (@spatial) primary; I can implement tests/harness side.
Flags: FEATURE_HEX_DASHBOARD, FEATURE_RICH_SEAT_LOCK_V10 (existing), FEATURE_HAND_CONSOLE_V11.
Guards: sidecar stream smoke; v11 boot; exporter parity.
